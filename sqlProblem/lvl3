//Level 3

//없어진 기록 찾기
SELECT OUTS.ANIMAL_ID, OUTS.NAME FROM ANIMAL_OUTS AS OUTS
LEFT JOIN ANIMAL_INS AS INS
ON OUTS.ANIMAL_ID = INS.ANIMAL_ID
WHERE INS.ANIMAL_ID IS NULL

//있었는데요 없었습니다
SELECT INS.ANIMAL_ID, INS.NAME FROM ANIMAL_OUTS AS OUTS
LEFT JOIN ANIMAL_INS AS INS
ON INS.ANIMAL_ID = OUTS.ANIMAL_ID
WHERE INS.DATETIME > OUTS.DATETIME
ORDER BY INS.DATETIME ASC

/*
* SELECT INS.ANIMAL_ID, INS.NAME FROM ANIMAL_OUTS AS OUTS, ANIMAL_INS AS INS
* WHERE INS.ANIMAL_ID = OUTS.ANIMAL_ID
* AND INS.DATETIME > OUTS.DATETIME
* ORDER BY INS.DATETIME ASC
*/

//오랜 기간 보호한 동물(1)
SELECT INS.NAME, INS.DATETIME FROM ANIMAL_INS AS INS
LEFT JOIN ANIMAL_OUTS AS OUTS
ON INS.ANIMAL_ID = OUTS.ANIMAL_ID
WHERE OUTS.ANIMAL_ID IS NULL
ORDER BY DATETIME
LIMIT 3

//오랜 기간 보호한 동물(2)
SELECT O1.ANIMAL_ID, O1.NAME
FROM ANIMAL_INS AS O1 JOIN ANIMAL_OUTS AS O2
WHERE O1.ANIMAL_ID = O2.ANIMAL_ID
ORDER BY O2.DATETIME-O1.DATETIME DESC
LIMIT 2